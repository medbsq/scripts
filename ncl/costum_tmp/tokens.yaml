id: api-key

info:
  name: Google API Key
  author: Swissky
  severity: medium

requests:
  - method: GET
    path:
      - "{{BaseURL}}"

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "AIza[0-9A-Za-z\\-_]{35}"
          - "(xox[p|b|o|a]-[0-9]{12}-[0-9]{12}-[0-9]{12}-[a-z0-9]{32})"
          - " PRIVATE KEY-----"
          - " PRIVATE KEY BLOCK-----"
          - "-----BEGIN PRIVATE KEY-----"
          - "-----BEGIN RSA PRIVATE KEY-----"
          - "-----BEGIN DSA PRIVATE KEY-----"
          - "-----BEGIN EC PRIVATE KEY-----"
          - "-----BEGIN PGP PRIVATE KEY BLOCK-----"
          - "AKIA[0-9A-Z]{16}"
          - "amzn\\.mws\\.[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}"
          - "AKIA[0-9A-Z]{16}"
          - "R_[0-9a-f]{32}"
          - "EAACEdEose0cBA[0-9A-Za-z]+"
          - "[g|G][i|I][t|T][h|H][u|U][b|B].*['|\"][0-9a-zA-Z]{35,40}['|\"]"
          - "[0-9]+-[0-9A-Za-z_]{32}\\.apps\\.googleusercontent\\.com"
          - "AIza[0-9A-Za-z\\-_]{35}"
          - "[0-9]+-[0-9A-Za-z_]{32}\\.apps\\.googleusercontent\\.com"
          - "service_account\""
          - "AIza[0-9A-Za-z\\-_]{35}"
          - "[0-9]+-[0-9A-Za-z_]{32}\\.apps\\.googleusercontent\\.com"
          - "ya29\\.[0-9A-Za-z\\-_]+"
          - "AIza[0-9A-Za-z\\-_]{35}"
          - "[0-9]+-[0-9A-Za-z_]{32}\\.apps\\.googleusercontent\\.com"
          - "[h|H][e|E][r|R][o|O][k|K][u|U].*[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}"
          - "[l|L][i|I][n|N][k|K][e|E][d|D][i|I][n|N].*['|\"][0-9a-zA-Z]{16}['|\"]"
          - "[0-9a-f]{32}-us[0-9]{1,2}"
          - "key-[0-9a-zA-Z]{32}"
          - "[a-zA-Z]{3,10}://[^/\\s:@]{3,20}:[^/\\s:@]{3,20}@.{1,100}[\"'\\s]"
          - "access_token\\$production\\$[0-9a-z]{16}\\$[0-9a-f]{32}"
          - "sk_live_[0-9a-z]{32}"
          - "sk_live_[0-9a-zA-Z]{24}"
          - "rk_live_[0-9a-zA-Z]{24}"
          - "sq0atp-[0-9A-Za-z\\-_]{22}"
          - "sq0csp-[0-9A-Za-z\\-_]{43}"
          - "SK[0-9a-fA-F]{32}"
          - "[t|T][w|W][i|I][t|T][t|T][e|E][r|R].*[1-9][0-9]+-[0-9a-zA-Z]{40}"
          - "[t|T][w|W][i|I][t:|T][t|T][e|E][r|R].*['|\"][0-9a-zA-Z]{35,44}['|\"]"
          - "^6[0-9a-zA-Z_-]{39}$"

    extractors:
      - type: regex
        part: body
        regex:
          - "AIza[0-9A-Za-z\\-_]{35}"
          - "(xox[p|b|o|a]-[0-9]{12}-[0-9]{12}-[0-9]{12}-[a-z0-9]{32})"
          - " PRIVATE KEY-----"
          - " PRIVATE KEY BLOCK-----"
          - "-----BEGIN PRIVATE KEY-----"
          - "-----BEGIN RSA PRIVATE KEY-----"
          - "-----BEGIN DSA PRIVATE KEY-----"
          - "-----BEGIN EC PRIVATE KEY-----"
          - "-----BEGIN PGP PRIVATE KEY BLOCK-----"
          - "AKIA[0-9A-Z]{16}"
          - "amzn\\.mws\\.[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}"
          - "AKIA[0-9A-Z]{16}"
          - "R_[0-9a-f]{32}"
          - "EAACEdEose0cBA[0-9A-Za-z]+"
          - "[g|G][i|I][t|T][h|H][u|U][b|B].*['|\"][0-9a-zA-Z]{35,40}['|\"]"
          - "[0-9]+-[0-9A-Za-z_]{32}\\.apps\\.googleusercontent\\.com"
          - "AIza[0-9A-Za-z\\-_]{35}"
          - "[0-9]+-[0-9A-Za-z_]{32}\\.apps\\.googleusercontent\\.com"
          - "service_account\""
          - "AIza[0-9A-Za-z\\-_]{35}"
          - "[0-9]+-[0-9A-Za-z_]{32}\\.apps\\.googleusercontent\\.com"
          - "ya29\\.[0-9A-Za-z\\-_]+"
          - "AIza[0-9A-Za-z\\-_]{35}"
          - "[0-9]+-[0-9A-Za-z_]{32}\\.apps\\.googleusercontent\\.com"
          - "[h|H][e|E][r|R][o|O][k|K][u|U].*[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}"
          - "[l|L][i|I][n|N][k|K][e|E][d|D][i|I][n|N].*['|\"][0-9a-zA-Z]{16}['|\"]"
          - "[0-9a-f]{32}-us[0-9]{1,2}"
          - "key-[0-9a-zA-Z]{32}"
          - "[a-zA-Z]{3,10}://[^/\\s:@]{3,20}:[^/\\s:@]{3,20}@.{1,100}[\"'\\s]"
          - "access_token\\$production\\$[0-9a-z]{16}\\$[0-9a-f]{32}"
          - "sk_live_[0-9a-z]{32}"
          - "sk_live_[0-9a-zA-Z]{24}"
          - "rk_live_[0-9a-zA-Z]{24}"
          - "sq0atp-[0-9A-Za-z\\-_]{22}"
          - "sq0csp-[0-9A-Za-z\\-_]{43}"
          - "SK[0-9a-fA-F]{32}"
          - "[t|T][w|W][i|I][t|T][t|T][e|E][r|R].*[1-9][0-9]+-[0-9a-zA-Z]{40}"
          - "[t|T][w|W][i|I][t:|T][t|T][e|E][r|R].*['|\"][0-9a-zA-Z]{35,44}['|\"]"
